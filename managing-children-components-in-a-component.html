<!DOCTYPE html>
<html>
<head>
    <meta charSet="utf-8"/>
    <title>brookjs - Managing children Components in a Component</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.0.0/normalize.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/brookjs/css/docs.css">
<link rel="stylesheet" href="/brookjs/css/prism-solarizedlight.css" type="text/css"></head>
<body>
<div class="content">
    <div class="menu">
        <header class="logo">
            <code>brookjs</code>
        </header>
        <nav class="menu-nav">
                <ul class="nav">
                    <span>Introduction</span>
                    <ul class="nav">
                            <li>
                                <a href="/brookjs/index.html">Meet <code>brookjs</code></a>
                            </li>
                            <li>
                                <a href="/brookjs/changelog.html">Changelog</a>
                            </li>
                    </ul>
                </ul>
                <ul class="nav">
                    <span>Writing a <code>brookjs</code> Component</span>
                    <ul class="nav">
                            <li>
                                <a href="/brookjs/what-is-a-component.html">What is a Component?</a>
                            </li>
                            <li>
                                <a href="/brookjs/defining-a-component.html">Defining a Component</a>
                            </li>
                            <li>
                                <a href="/brookjs/writing-a-components-html.html">Writing a Component's HTML</a>
                            </li>
                            <li>
                                <a href="/brookjs/adding-events-to-a-component.html">Adding <code>events</code> to a Component</a>
                            </li>
                            <li>
                                <a href="/brookjs/using-a-template-to-render-a-component.html">Using a Template to <code>render</code> a Component</a>
                            </li>
                            <li>
                                <a href="/brookjs/managing-children-components-in-a-component.html">Managing <code>children</code> Components</a>
                            </li>
                    </ul>
                </ul>
                <ul class="nav">
                    <span>Building a <code>brookjs</code> Application</span>
                    <ul class="nav">
                            <li>
                                <a href="/brookjs/connecting-a-redux-store-to-the-view.html">Connecting a Redux Store to the View</a>
                            </li>
                            <li>
                                <a href="/brookjs/implementing-side-effects-with-custom-delta.html">Implementing Side Effects with Custom Delta</a>
                            </li>
                            <li>
                                <a href="/brookjs/building-the-reducer-with-combineActionReducers.html">Building the Reducer with <code>combineActionReducers</code></a>
                            </li>
                            <li>
                                <a href="/brookjs/bootstrapping-the-application.html">Bootstrapping the Application</a>
                            </li>
                    </ul>
                </ul>
                <ul class="nav">
                    <span>Advanced Component Techniques</span>
                    <ul class="nav">
                            <li>
                                <a href="/brookjs/custom-components-with-blackboxing-and-onmount.html">Custom Components with Blackboxing and <code>onMount</code></a>
                            </li>
                            <li>
                                <a href="/brookjs/animating-a-component.html">Animating a Component</a>
                            </li>
                    </ul>
                </ul>
                <ul class="nav">
                    <span>API</span>
                    <ul class="nav">
                            <li>
                                <a href="/brookjs/component.html">component</a>
                            </li>
                            <li>
                                <a href="/brookjs/observeDelta.html">observeDelta</a>
                            </li>
                            <li>
                                <a href="/brookjs/events.html">events</a>
                            </li>
                            <li>
                                <a href="/brookjs/render.html">render</a>
                            </li>
                            <li>
                                <a href="/brookjs/children.html">children</a>
                            </li>
                            <li>
                                <a href="/brookjs/combineActionReducers.html">combineActionReducers</a>
                            </li>
                            <li>
                                <a href="/brookjs/action.html">action</a>
                            </li>
                            <li>
                                <a href="/brookjs/helpers.html">helpers</a>
                            </li>
                    </ul>
                </ul>
        </nav>
    </div>

    <div class="page">
        <h1>Managing <code>children</code> Components in a Component</h1>
        <main class="page-content">
            <p>A Component should encapsulate a specific piece of functionality, making it easy to reuse them in other Components. The <code>children</code> module handles this functionality, managing the creation of child components and plugging their streams into the parent. It uses the child component’s <code>data-brk-container</code> attribute to mount and unmount the component when it enters and exits the DOM.</p>
<p>The <code>children</code> function accepts multiple configurations, depending on how much customization the component requires. The simplest configuration maps a child’s <code>data-brk-container</code> attribute to its Component factory function. Given a child that looks like this:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">data-brk-container</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">data-brk-onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onButtonClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Click me<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
</code></pre>
<p>A parent component would mount the component like this:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> component<span class="token punctuation">,</span> children <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'brookjs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> button <span class="token keyword">from</span> <span class="token string">'./button'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    children<span class="token punctuation">:</span> <span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">{</span> button <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>When the component gets mounted, <code>children</code> mounts child element with its events, children, and onMount streams. This works ideally if the child component doesn’t need any custom props or behavior and the default events emitted by the component work fine.</p>
<p>However, most of the time, more customization will be required. <code>children</code> offers a number of hooks to modify the way the child and parent are bound. The first is <code>modifyChildProps</code>, which gets called with the parent’s <code>props$</code> stream and the child’s <code>data-brk-key</code> attribute value, if present. The returned stream gets passed, along with the child’s element, into the child’s <code>onMount</code> function, defined on its <code>factory</code>, which should be a <code>brookjs</code> component:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> component<span class="token punctuation">,</span> children <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'brookjs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> selectButtonProps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./selector'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> button <span class="token keyword">from</span> <span class="token string">'./button'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    children<span class="token punctuation">:</span> <span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        button<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            factory<span class="token punctuation">:</span> button<span class="token punctuation">,</span>
            modifyChildProps<span class="token punctuation">:</span> <span class="token punctuation">(</span>props$<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> props$<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>selectButtonProps<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Additionally, <code>preplug</code> provides access to the child <code>instance$</code> before it gets plugged into the parent, allowing it to by modified before it gets plugged into the parent stream. This can be used to map a child’s more generic actions to more specific, contextual actions:</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> component<span class="token punctuation">,</span> children <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'brookjs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> button <span class="token keyword">from</span> <span class="token string">'./button'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    children<span class="token punctuation">:</span> <span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        button<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            factory<span class="token punctuation">:</span> button<span class="token punctuation">,</span>
            modifyChildProps<span class="token punctuation">:</span> <span class="token punctuation">(</span>props$<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> props$<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>mapToChildProps<span class="token punctuation">)</span><span class="token punctuation">,</span>
            preplug<span class="token punctuation">:</span> <span class="token punctuation">(</span>child$<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> child$<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>action <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'CLICK'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    action <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        type<span class="token punctuation">:</span> <span class="token string">'SUBMIT_CLICK'</span><span class="token punctuation">,</span>
                        meta<span class="token punctuation">:</span> <span class="token punctuation">{</span> key <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> action<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>A helper function, <a href="helpers.html"><code>mapActionTo</code></a> is provided to simplify this pattern.</p>
<h2 id="A-Note-About-the-data-brk-key-Attribute"><a href="#A-Note-About-the-data-brk-key-Attribute" class="headerlink" title="A Note About the data-brk-key Attribute"></a>A Note About the <code>data-brk-key</code> Attribute</h2><p>If a Component is going to be iterated over in a parent, the <code>data-brk-key</code> attribute is <strong>highly recommended</strong> for performance. If the child element doesn’t have the attribute, the above two functions will be called with <code>null</code> as the key.</p>
<p>The value of the attribute should be unique amongst children of the same type in a parent Component. The <code>render</code> module also uses this to reuse a Component when it’s been moved to a new location but is otherwise the same instance. Rendering a Component with multiple children that share both a type and a key will result in unexpected behavior.</p>

        </main>
    </div>
</div>

<footer class="brk-footer">
    <a class="footer" href="https://github.com/valtech-nyc/brookjs">
        Project on github
    </a>

    <div class="switch-page">
    </div>
</footer>
</body>
</html>
