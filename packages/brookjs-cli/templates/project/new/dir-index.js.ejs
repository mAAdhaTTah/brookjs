---
to: <%= name %>/<%= dir %>/index.js
---
import '@babel/polyfill';
import React from 'react';
import { observeDelta, eddy } from 'brookjs';
import { RootJunction } from 'brookjs-silt';
import { applyMiddleware, createStore } from 'redux';
import { connect } from 'react-redux';
import { composeWithDevTools } from 'redux-devtools-extension/developmentOnly';
import ReactDOM from 'react-dom';
import { init } from './actions';
import { App } from './components';
import { reducer, mapStateToProps } from './state';

const { __INITIAL_STATE__ = {} } = global;

const compose = composeWithDevTools({
  name: 'test-app'
});

const store = createStore(
  reducer,
  __INITIAL_STATE__,
  compose(applyMiddleware(observeDelta()), eddy())
);

const Root = connect(mapStateToProps)(App);

ReactDOM.render(
  <RootJunction root$={root$ => root$.observe(store.dispatch)}>
    <Root />
  </RootJunction>,
  document.getElementById('app')
);

store.dispatch(init());
